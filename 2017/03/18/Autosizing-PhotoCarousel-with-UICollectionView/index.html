<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset="utf-8">
    
    <title>Autosizing UICollectionView carousel during rotation | Villy G&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="In my previous post I demonstrated how to use AutoLayout and make UIImageView resize to full screen when in landscape mode. While happy with the outcome - the solution was not exactly what I wanted in">
<meta property="og:type" content="article">
<meta property="og:title" content="Autosizing UICollectionView carousel during rotation">
<meta property="og:url" content="http://villyg.com/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/index.html">
<meta property="og:site_name" content="Villy G's blog">
<meta property="og:description" content="In my previous post I demonstrated how to use AutoLayout and make UIImageView resize to full screen when in landscape mode. While happy with the outcome - the solution was not exactly what I wanted in">
<meta property="og:image" content="http://villyg.com/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/simulator_screen_2.png">
<meta property="og:image" content="http://villyg.com/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/simulator_screen_3.png">
<meta property="og:image" content="http://villyg.com/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/simulator_screen_0.png">
<meta property="og:image" content="http://villyg.com/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/simulator_screen_1.png">
<meta property="og:updated_time" content="2017-03-18T14:39:22.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Autosizing UICollectionView carousel during rotation">
<meta name="twitter:description" content="In my previous post I demonstrated how to use AutoLayout and make UIImageView resize to full screen when in landscape mode. While happy with the outcome - the solution was not exactly what I wanted in">
<meta name="twitter:image" content="http://villyg.com/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/simulator_screen_2.png">
    

    
        <link rel="alternate" href="/" title="Villy G&#39;s blog" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-91929908-1', 'auto');
ga('send', 'pageview');

</script>
    
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                
                <span class="site-title">Villy G&#39;s blog</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/archives">Blog</a>
                
                    <a class="main-nav-link" href="/projects">Projects</a>
                
                    <a class="main-nav-link" href="/about">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/avatar.png" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/archives">Blog</a></td>
                
                    <td><a class="main-nav-link" href="/projects">Projects</a></td>
                
                    <td><a class="main-nav-link" href="/about">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/avatar.png" />
            <h2 id="name">Villy G</h2>
            <h3 id="title">Software Craftsman</h3>
            <span id="location"><i class="fa fa-map-marker"></i>Pittsburgh, PA USA</span>
            <a id="follow" target="_blank" href="https://github.com/villyg/">FOLLOW</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                2
                <span>posts</span>
            </div>
            <div class="article-info-block">
                2
                <span>tags</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="mailto:villyg@icloud.com" target="_blank" title="envelope-o" class=tooltip>
                            <i class="fa fa-envelope-o"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="http://github.com/villyg" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://twitter.com/VillyG" target="_blank" title="twitter" class=tooltip>
                            <i class="fa fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="rss" class=tooltip>
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main"><article id="post-Autosizing-PhotoCarousel-with-UICollectionView" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
            Autosizing UICollectionView carousel during rotation
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/">
            <time datetime="2017-03-18T12:57:44.000Z" itemprop="datePublished">2017-03-18</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Development/">Development</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Swift/">Swift</a>, <a class="tag-link" href="/tags/iOS/">iOS</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>In my previous post I demonstrated how to use AutoLayout and make UIImageView resize to full screen when in landscape mode. While happy with the outcome - the solution was not exactly what I wanted in the 1.2 version of Gun Vault. I wanted to allow to user to view all images from the item details screen using a scrollable carousel-style UICollectionView. I still wanted to have the carousel resize to full screen when in landscape mode as well prepare for future iPad oriented optimizations. It turned out that making a UICollectionView behave the same way as a UIImageView is much more difficult so I hope this article saves you time if you are trying to accomplish something similar so let’s get going.</p>
<a id="more"></a>
<h2 id="Rotation-support"><a href="#Rotation-support" class="headerlink" title="Rotation support"></a>Rotation support</h2><p>Our view controller will contains a UICollectionView and few sample images</p>
<figure class="highlight swift"><figcaption><span>MainController.swift</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keyword">var</span> images: [<span class="type">UIImage</span>] = &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> image1: <span class="type">UIImage</span> = <span class="type">UIImage</span>(named: <span class="string">"image1"</span>)!</div><div class="line">        <span class="keyword">let</span> image2: <span class="type">UIImage</span> = <span class="type">UIImage</span>(named: <span class="string">"image2"</span>)!</div><div class="line">        <span class="keyword">let</span> image3: <span class="type">UIImage</span> = <span class="type">UIImage</span>(named: <span class="string">"image3"</span>)!</div><div class="line">        <span class="keyword">let</span> image4: <span class="type">UIImage</span> = <span class="type">UIImage</span>(named: <span class="string">"image4"</span>)!</div><div class="line">        </div><div class="line">        <span class="keyword">var</span> result: [<span class="type">UIImage</span>] = []</div><div class="line">        result.append(image1)</div><div class="line">        result.append(image2)</div><div class="line">        result.append(image3)</div><div class="line">        result.append(image4)</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> result</div><div class="line">        </div><div class="line">    &#125;()</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keyword">var</span> collectionView: <span class="type">UICollectionView</span> = &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> frame = <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">0</span>, height: <span class="number">0</span>)</div><div class="line">        <span class="keyword">let</span> layout = <span class="type">UICollectionViewFlowLayout</span>()</div><div class="line">        layout.scrollDirection = .horizontal</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> result = <span class="type">UICollectionView</span>(frame: frame, collectionViewLayout: layout)</div><div class="line">        result.backgroundColor = <span class="type">UIColor</span>.darkGray</div><div class="line">        result.isPagingEnabled = <span class="literal">true</span></div><div class="line">        result.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></div><div class="line">        </div><div class="line">        </div><div class="line">        <span class="keyword">return</span> result</div><div class="line">        </div><div class="line">    &#125;()</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keyword">var</span> commonConstraints: [<span class="type">NSLayoutConstraint</span>] = []</div><div class="line">    <span class="keyword">var</span> landscapeConstraints: [<span class="type">NSLayoutConstraint</span>] = []</div><div class="line">    <span class="keyword">var</span> portraitConstraints: [<span class="type">NSLayoutConstraint</span>] = []</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.viewDidLoad()</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.collectionView.register(<span class="type">ImageCell</span>.<span class="keyword">self</span>, forCellWithReuseIdentifier: <span class="type">ImageCell</span>.reuseIdentifer)</div><div class="line">        <span class="keyword">self</span>.collectionView.delegate = <span class="keyword">self</span></div><div class="line">        <span class="keyword">self</span>.collectionView.dataSource = <span class="keyword">self</span></div><div class="line">        <span class="keyword">self</span>.automaticallyAdjustsScrollViewInsets = <span class="literal">false</span></div><div class="line">        <span class="keyword">self</span>.view.addSubview(collectionView)</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">traitCollectionDidChange</span><span class="params">(<span class="number">_</span> previousTraitCollection: UITraitCollection?)</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.traitCollectionDidChange(previousTraitCollection)</div><div class="line">        </div><div class="line">        <span class="comment">// same as having the code block in viewDidLoad</span></div><div class="line">        </div><div class="line">        <span class="keyword">if</span> commonConstraints.isEmpty &#123;</div><div class="line">           </div><div class="line">            <span class="keyword">var</span> collectionViewHeightMultiplierWhenInPortrait: <span class="type">CGFloat</span> = <span class="number">0.33</span></div><div class="line">            <span class="keyword">if</span> <span class="keyword">self</span>.traitCollection.userInterfaceIdiom == .pad &#123; collectionViewHeightMultiplierWhenInPortrait = <span class="number">0.5</span> &#125;</div><div class="line">            </div><div class="line">            </div><div class="line">            <span class="comment">// define collection view common, portrait and landscape constraints</span></div><div class="line">            </div><div class="line">            commonConstraints.append(<span class="type">NSLayoutConstraint</span>(item: collectionView, attribute: .leading, relatedBy: .<span class="built_in">equal</span>, toItem: view, attribute: .leading, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">            commonConstraints.append(<span class="type">NSLayoutConstraint</span>(item: collectionView, attribute: .top, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>.topLayoutGuide, attribute: .bottom, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">            commonConstraints.append(<span class="type">NSLayoutConstraint</span>(item: collectionView, attribute: .trailing, relatedBy: .<span class="built_in">equal</span>, toItem: view, attribute: .trailing, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">            </div><div class="line">            portraitConstraints.append(<span class="type">NSLayoutConstraint</span>(item: collectionView, attribute: .height, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>.view, attribute: .height, multiplier: collectionViewHeightMultiplierWhenInPortrait, constant: <span class="number">0</span>))</div><div class="line">            </div><div class="line">            landscapeConstraints.append(<span class="type">NSLayoutConstraint</span>(item: collectionView, attribute: .height, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>.view, attribute: .height, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">            </div><div class="line">            <span class="comment">// activate common constriants</span></div><div class="line">            </div><div class="line">            <span class="type">NSLayoutConstraint</span>.activate(commonConstraints)</div><div class="line">        </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        <span class="keyword">if</span> traitCollection.verticalSizeClass != previousTraitCollection?.verticalSizeClass &#123;</div><div class="line">        </div><div class="line">            </div><div class="line">            <span class="type">NSLayoutConstraint</span>.deactivate(landscapeConstraints)</div><div class="line">            <span class="type">NSLayoutConstraint</span>.deactivate(portraitConstraints)</div><div class="line">            </div><div class="line">            <span class="keyword">if</span> traitCollection.verticalSizeClass == .regular &#123;</div><div class="line">                </div><div class="line">                <span class="keyword">self</span>.navigationController?.setNavigationBarHidden(<span class="literal">false</span>, animated: <span class="literal">true</span>)</div><div class="line">                <span class="type">NSLayoutConstraint</span>.activate(portraitConstraints)</div><div class="line">                </div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                </div><div class="line">                <span class="keyword">self</span>.navigationController?.setNavigationBarHidden(<span class="literal">true</span>, animated: <span class="literal">true</span>)</div><div class="line">                <span class="type">NSLayoutConstraint</span>.activate(landscapeConstraints)</div><div class="line">            </div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            <span class="keyword">self</span>.collectionView.collectionViewLayout.invalidateLayout()</div><div class="line">            </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">    &#125;    </div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MainController</span>: <span class="title">UICollectionViewDataSource</span> </span>&#123;</div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: UICollectionView, numberOfItemsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    </div><div class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.images.<span class="built_in">count</span></div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: UICollectionView, cellForItemAt indexPath: IndexPath)</span></span> -&gt; <span class="type">UICollectionViewCell</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">let</span> cell = collectionView.dequeueReusableCell(withReuseIdentifier: <span class="type">ImageCell</span>.reuseIdentifer, <span class="keyword">for</span>: indexPath) <span class="keyword">as</span>! <span class="type">ImageCell</span></div><div class="line">        </div><div class="line">        <span class="keyword">let</span> image: <span class="type">UIImage</span> = images[indexPath.row]</div><div class="line">        </div><div class="line">        cell.imageView.image = image</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> cell</div><div class="line">        </div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MainController</span>: <span class="title">UICollectionViewDelegateFlowLayout</span> </span>&#123;</div><div class="line">    </div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, sizeForItemAt indexPath: IndexPath)</span></span> -&gt; <span class="type">CGSize</span> &#123;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> collectionView.frame.size</div><div class="line">    </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, minimumLineSpacingForSectionAt section: Int)</span></span> -&gt; <span class="type">CGFloat</span> &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="number">0.0</span></div><div class="line">    </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">collectionView</span><span class="params">(<span class="number">_</span> collectionView: UICollectionView, layout collectionViewLayout: UICollectionViewLayout, minimumInteritemSpacingForSectionAt section: Int)</span></span> -&gt; <span class="type">CGFloat</span> &#123;</div><div class="line">       </div><div class="line">        <span class="keyword">return</span> <span class="number">0.0</span></div><div class="line">    </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
<p>Let’s go over the code. </p>
<p>In viewDidLoad() we simply build our UI - we add a UICollectionView as a subview to the MainController’s view and turn on paging. Line 53 is important because othwerise we’ll get a bunch of errors around insets. </p>
<p>In traitCollectionDidChange() we do most of the heavy lifting around AutoLayout. While the instructions look familiar, you might be used to seeing them in viewDidLoad() instead. The traitCollectionDidChange() method is actually equally if not better suited for setting up all AutoLayout stuff with the added benefit of keeping your viewDidLoad() slimmer. Similar to viewDidLoad() it also gets called on initial load but unlike viewDidLoad() it gets called again when there are changes to the UI - in example when the device is rotated or when on iPad a view is resized. As usual - there are some gotchas when it doesn’t happen but it is perfect for our use case. We’ll use it to set up some common constraints that will remain the same no matter what the orientation is as well as use it as a trigger to activate/deactivate portraint or landscape constraints only - show/hide the navbar, resize the collection view to full screen and back and so on.</p>
<p>The only other thing we need is a UICollectionViewCell with a UIImageView inside.</p>
<figure class="highlight swift"><figcaption><span>ImageCell.swift</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageCell</span>: <span class="title">UICollectionViewCell</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> reuseIdentifer: <span class="type">String</span> = <span class="type">String</span>(describing: type(of: <span class="keyword">self</span>))</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> imageView: <span class="type">UIImageView</span>!</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</div><div class="line">        </div><div class="line">        imageView = <span class="type">UIImageView</span>()</div><div class="line">        contentView.addSubview(imageView)</div><div class="line">        backgroundColor = <span class="type">UIColor</span>.yellow</div><div class="line">        imageView.contentMode = .scaleAspectFill</div><div class="line">        imageView.clipsToBounds = <span class="literal">true</span></div><div class="line">        imageView.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></div><div class="line">        imageView.widthAnchor.constraint(equalTo: contentView.widthAnchor, multiplier: <span class="number">1.0</span>).isActive = <span class="literal">true</span></div><div class="line">        imageView.heightAnchor.constraint(equalTo: contentView.heightAnchor, multiplier: <span class="number">1.0</span>).isActive = <span class="literal">true</span></div><div class="line">        imageView.centerXAnchor.constraint(equalTo: contentView.centerXAnchor, constant: <span class="number">0.0</span>).isActive = <span class="literal">true</span></div><div class="line">        imageView.centerYAnchor.constraint(equalTo: contentView.centerYAnchor, constant: <span class="number">0.0</span>).isActive = <span class="literal">true</span></div><div class="line">        </div><div class="line">        </div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">        <span class="built_in">fatalError</span>(<span class="string">"init(coder:) has not been implemented"</span>)</div><div class="line">    &#125;   </div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
<p>If we run the example and rotate the device everything will look as expected as long as we stay on the first image. As soon as we go to the next and rotate again we’ll uncover our first bug.</p>
<img src="/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/simulator_screen_2.png" alt="Second image bug" title="Second image bug">
<h2 id="Fixing-up-offset"><a href="#Fixing-up-offset" class="headerlink" title="Fixing up offset"></a>Fixing up offset</h2><p>The reason for our bug is very simple - we turned on paging but we forgot to instruct our collection view how to handle changes in page size so let’s go ahead and do that. We’ll add the following method to our MainController</p>
<figure class="highlight swift"><figcaption><span>MainController.swift</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewWillTransition</span><span class="params">(to size: CGSize, with coordinator: UIViewControllerTransitionCoordinator)</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewWillTransition(to: size, with: coordinator)</div><div class="line">    </div><div class="line">    <span class="built_in">print</span>(<span class="string">"before"</span>)</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> visiblePage = <span class="keyword">self</span>.collectionView.contentOffset.x / <span class="keyword">self</span>.collectionView.bounds.size.width</div><div class="line"></div><div class="line">    coordinator.animate(alongsideTransition: &#123; (context) <span class="keyword">in</span></div><div class="line">        </div><div class="line">        <span class="built_in">print</span>(<span class="string">"during"</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> newOffset = <span class="type">CGPoint</span>(x: visiblePage * <span class="keyword">self</span>.collectionView.bounds.size.width, y: <span class="keyword">self</span>.collectionView.contentOffset.y)</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.collectionView.contentOffset = newOffset</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.collectionView.collectionViewLayout.invalidateLayout()</div><div class="line">        </div><div class="line">    &#125;) &#123; (context) <span class="keyword">in</span></div><div class="line">        </div><div class="line">        <span class="built_in">print</span>(<span class="string">"after"</span>)</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">            </div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
<p>The code in the viewWillTransitionToSize() method will figure out the current page and will instruct the transition coordinator to adjust the collection view’s offset to the appropriate X coordinate as part of the animation during rotation. This method is relatively new so I added few print statements to show you what gets called when. If you run the app now you will see that our bug is fixed.</p>
<img src="/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/simulator_screen_3.png" alt="Second image bug fixed" title="Second image bug fixed">
<h2 id="Smoothing-things-out"><a href="#Smoothing-things-out" class="headerlink" title="Smoothing things out"></a>Smoothing things out</h2><p>While it is mission accomplished already as far as the main use case goes, those of us that are a bit more detail oriented have probably already noticed the weird artifacts happening during rotation. If you are not one of them - run the app again and pay closer attention - do you see the flickering now? I bet you do. Let’s go ahead and address it.</p>
<p>Rather than tinckering with the UICollectionView’s animation we’ll use a very simple trick using a hidden UIImageView with the same constraints as the UICollectionView.</p>
<ul>
<li>Before rotation: take a snapshot of the currently displayed image and load it in the image view; hide the collection view and show the image view. </li>
<li>During rotation: rotate both the image view and the collection view</li>
<li>After rotation: hide the image view and show the collection view</li>
</ul>
<p>Let’s add our image view to the controller as well as update the AutoLayout instructions.</p>
<figure class="highlight swift"><figcaption><span>MainController.swift</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> tempImageView: <span class="type">UIImageView</span> = &#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> result = <span class="type">UIImageView</span>()</div><div class="line">    result.contentMode = .scaleAspectFill</div><div class="line">    result.clipsToBounds = <span class="literal">true</span></div><div class="line">    result.translatesAutoresizingMaskIntoConstraints = <span class="literal">false</span></div><div class="line">    result.isHidden = <span class="literal">true</span></div><div class="line">    <span class="keyword">return</span> result</div><div class="line">    </div><div class="line">&#125;()</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewDidLoad()</div><div class="line">    </div><div class="line">    <span class="keyword">self</span>.collectionView.register(<span class="type">ImageCell</span>.<span class="keyword">self</span>, forCellWithReuseIdentifier: <span class="type">ImageCell</span>.reuseIdentifer)</div><div class="line">    <span class="keyword">self</span>.collectionView.delegate = <span class="keyword">self</span></div><div class="line">    <span class="keyword">self</span>.collectionView.dataSource = <span class="keyword">self</span></div><div class="line">    <span class="keyword">self</span>.automaticallyAdjustsScrollViewInsets = <span class="literal">false</span></div><div class="line">    <span class="keyword">self</span>.view.addSubview(collectionView)</div><div class="line">    <span class="keyword">self</span>.view.addSubview(tempImageView)</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">traitCollectionDidChange</span><span class="params">(<span class="number">_</span> previousTraitCollection: UITraitCollection?)</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.traitCollectionDidChange(previousTraitCollection)</div><div class="line">    </div><div class="line">    <span class="comment">// same as having the code block in viewDidLoad</span></div><div class="line">    </div><div class="line">    <span class="keyword">if</span> commonConstraints.isEmpty &#123;</div><div class="line">       </div><div class="line">        <span class="keyword">var</span> collectionViewHeightMultiplierWhenInPortrait: <span class="type">CGFloat</span> = <span class="number">0.33</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">self</span>.traitCollection.userInterfaceIdiom == .pad &#123; collectionViewHeightMultiplierWhenInPortrait = <span class="number">0.5</span> &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        <span class="comment">// define collection view common, portrait and landscape constraints</span></div><div class="line">        </div><div class="line">        commonConstraints.append(<span class="type">NSLayoutConstraint</span>(item: collectionView, attribute: .leading, relatedBy: .<span class="built_in">equal</span>, toItem: view, attribute: .leading, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">        commonConstraints.append(<span class="type">NSLayoutConstraint</span>(item: collectionView, attribute: .top, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>.topLayoutGuide, attribute: .bottom, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">        commonConstraints.append(<span class="type">NSLayoutConstraint</span>(item: collectionView, attribute: .trailing, relatedBy: .<span class="built_in">equal</span>, toItem: view, attribute: .trailing, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">        </div><div class="line">        portraitConstraints.append(<span class="type">NSLayoutConstraint</span>(item: collectionView, attribute: .height, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>.view, attribute: .height, multiplier: collectionViewHeightMultiplierWhenInPortrait, constant: <span class="number">0</span>))</div><div class="line">        </div><div class="line">        landscapeConstraints.append(<span class="type">NSLayoutConstraint</span>(item: collectionView, attribute: .height, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>.view, attribute: .height, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">        </div><div class="line">        <span class="comment">// define temp image view common, portrait and landscape constraints</span></div><div class="line">        </div><div class="line">        commonConstraints.append(<span class="type">NSLayoutConstraint</span>(item: tempImageView, attribute: .leading, relatedBy: .<span class="built_in">equal</span>, toItem: view, attribute: .leading, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">        commonConstraints.append(<span class="type">NSLayoutConstraint</span>(item: tempImageView, attribute: .top, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>.topLayoutGuide, attribute: .bottom, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">        commonConstraints.append(<span class="type">NSLayoutConstraint</span>(item: tempImageView, attribute: .trailing, relatedBy: .<span class="built_in">equal</span>, toItem: view, attribute: .trailing, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">        </div><div class="line">        portraitConstraints.append(<span class="type">NSLayoutConstraint</span>(item: tempImageView, attribute: .height, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>.view, attribute: .height, multiplier: collectionViewHeightMultiplierWhenInPortrait, constant: <span class="number">0</span>))</div><div class="line">        </div><div class="line">        landscapeConstraints.append(<span class="type">NSLayoutConstraint</span>(item: tempImageView, attribute: .height, relatedBy: .<span class="built_in">equal</span>, toItem: <span class="keyword">self</span>.view, attribute: .height, multiplier: <span class="number">1.0</span>, constant: <span class="number">0</span>))</div><div class="line">        </div><div class="line">        <span class="comment">// activate common constriants</span></div><div class="line">        </div><div class="line">        <span class="type">NSLayoutConstraint</span>.activate(commonConstraints)</div><div class="line">    </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keyword">if</span> traitCollection.verticalSizeClass != previousTraitCollection?.verticalSizeClass &#123;</div><div class="line">    </div><div class="line">        </div><div class="line">        <span class="type">NSLayoutConstraint</span>.deactivate(landscapeConstraints)</div><div class="line">        <span class="type">NSLayoutConstraint</span>.deactivate(portraitConstraints)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> traitCollection.verticalSizeClass == .regular &#123;</div><div class="line">            </div><div class="line">            <span class="keyword">self</span>.navigationController?.setNavigationBarHidden(<span class="literal">false</span>, animated: <span class="literal">true</span>)</div><div class="line">            <span class="type">NSLayoutConstraint</span>.activate(portraitConstraints)</div><div class="line">            </div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            </div><div class="line">            <span class="keyword">self</span>.navigationController?.setNavigationBarHidden(<span class="literal">true</span>, animated: <span class="literal">true</span>)</div><div class="line">            <span class="type">NSLayoutConstraint</span>.activate(landscapeConstraints)</div><div class="line">        </div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.collectionView.collectionViewLayout.invalidateLayout()</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
<p>And finally, let’s update our viewWillTransitionToSize() method to do the swapping trick</p>
<figure class="highlight swift"><figcaption><span>MainController.swift</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewWillTransition</span><span class="params">(to size: CGSize, with coordinator: UIViewControllerTransitionCoordinator)</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.viewWillTransition(to: size, with: coordinator)</div><div class="line">    </div><div class="line">    <span class="built_in">print</span>(<span class="string">"before"</span>)</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> visiblePage = <span class="keyword">self</span>.collectionView.contentOffset.x / <span class="keyword">self</span>.collectionView.bounds.size.width</div><div class="line">    </div><div class="line">    <span class="keyword">self</span>.tempImageView.image = <span class="keyword">self</span>.images[<span class="type">Int</span>(visiblePage)]</div><div class="line">  </div><div class="line">    <span class="keyword">self</span>.collectionView.isHidden = <span class="literal">true</span></div><div class="line">    <span class="keyword">self</span>.tempImageView.isHidden = <span class="literal">false</span></div><div class="line"></div><div class="line">    coordinator.animate(alongsideTransition: &#123; (context) <span class="keyword">in</span></div><div class="line">        </div><div class="line">        <span class="built_in">print</span>(<span class="string">"during"</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> newOffset = <span class="type">CGPoint</span>(x: visiblePage * <span class="keyword">self</span>.collectionView.bounds.size.width, y: <span class="keyword">self</span>.collectionView.contentOffset.y)</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.collectionView.contentOffset = newOffset</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.collectionView.collectionViewLayout.invalidateLayout()</div><div class="line">        </div><div class="line">    &#125;) &#123; (context) <span class="keyword">in</span></div><div class="line">        </div><div class="line">        <span class="built_in">print</span>(<span class="string">"after"</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">self</span>.tempImageView.isHidden = <span class="literal">true</span></div><div class="line">        <span class="keyword">self</span>.collectionView.isHidden = <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
<p>And that’s it. Now we have a much nicer UICollectionView with AutoSizing support for iPhone and iPad orientation changes.</p>
<img src="/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/simulator_screen_0.png" alt="Portrait view" title="Portrait view">
<img src="/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/simulator_screen_1.png" alt="Landscape view" title="Landscape view">
<p><a href="https://github.com/villyg/PhotoCarousel-Swift" target="_blank" rel="external">Download full code here</a></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://villyg.com/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/" data-id="cj0fd0jwa0002nhxwjbvzwpzs" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://villyg.com/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="http://villyg.com/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/">Comments</a>
    

        </footer>
    </div>
    
        
<nav id="article-nav">
    
    
        <a href="/2017/02/27/Adding-image-on-top-of-UITableView/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Older</strong>
            <div class="article-nav-title">Adding image on top of UITableView</div>
        </a>
    
</nav>


    
</article>


    
    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>

</section>
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">recent</h3>
        <div class="widget">
            <ul id="recent-post" class="no-thumbnail">
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Development/">Development</a></p>
                            <p class="item-title"><a href="/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/" class="title">Autosizing UICollectionView carousel during rotation</a></p>
                            <p class="item-date"><time datetime="2017-03-18T12:57:44.000Z" itemprop="datePublished">2017-03-18</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Development/">Development</a></p>
                            <p class="item-title"><a href="/2017/02/27/Adding-image-on-top-of-UITableView/" class="title">Adding image on top of UITableView</a></p>
                            <p class="item-date"><time datetime="2017-02-28T01:36:18.000Z" itemprop="datePublished">2017-02-27</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">categories</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/">Development</a><span class="category-list-count">2</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tags</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swift/">Swift</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iOS/">iOS</a><span class="tag-list-count">2</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/Swift/" style="font-size: 10px;">Swift</a> <a href="/tags/iOS/" style="font-size: 10px;">iOS</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2017 Villy G<br>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_config = function () {
        
            this.page.url = 'http://villyg.com/2017/03/18/Autosizing-PhotoCarousel-with-UICollectionView/';
        
        this.page.identifier = 'Autosizing-PhotoCarousel-with-UICollectionView';
    };
    (function() { 
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'villyg' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>



    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>